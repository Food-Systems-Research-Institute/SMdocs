{
  "hash": "f788de1f6feb8a79bad5f77ed00f4da6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"bnlearn\"\nformat:\n  html:\n    fig-dpi: 200\n    code-fold: false\neditor_options: \n  chunk_output_type: console\nwarnings: false\n---\n\n\n\n::: {.callout-note collapse='false' title='Caution'}\nMetrics and analyses for the Frontiers special issue are works in progress. There are some metric cleanliness issues here that I'm putting off for now until we work back through the county metrics.\n:::\n\nTesting out a Bayesian Network with structural learning to identify drivers in our food systems data. Playing around with county level metrics. Note that when we do this for real it should probably be aggregated at indicator level.\n\n## Housekeeping\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# if (!require('graph')) BiocManager::install('graph')\n# if (!require('Rgraphviz')) BiocManager::install('Rgraphviz')\n\npacman::p_load(\n  dplyr,\n  bnlearn,\n  conflicted,\n  stringr,\n  purrr,\n  tidyr,\n  skimr,\n  knitr,\n  reactable,\n  graph,\n  Rgraphviz,\n  snakecase,\n  graph\n)\n\nsource('dev/data_pipeline_functions.R')\nsource('dev/get_reactable.R')\n\nconflicted::conflicts_prefer(\n  dplyr::filter(),\n  dplyr::select(),\n  base::setdiff(),\n  base::intersect(),\n  base::union(),\n  igraph::degree(),\n  bnlearn::score(),\n  graph::nodes(),\n  .quiet = TRUE\n)\n```\n:::\n\n\n\n## Wrangling\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pull county time series variables\nvars <- readRDS('data/frontiers/county_time_series_vars.rds')\nsm_data <- readRDS('data/sm_data.rds')[['metrics']]\n\n# Get county variables only, and lose CT\ndat <- sm_data %>% \n  filter(\n    str_length(fips) == 5,\n    variable_name %in% vars,\n    value != -666666666,\n    str_detect(fips, '^09', negate = TRUE)\n  ) %>% \n  mutate(across(c(year, value), ~ as.numeric(.x)))\nget_str(dat)\n\n# Get latest year only, then pivot wider for analysis\ndat <- dat %>% \n  get_latest_year(add_suffix = FALSE) %>% \n  pivot_wider(\n    id_cols = fips,\n    values_from = value,\n    names_from = variable_name\n  )\nget_str(dat)\n\n# Check missing\n(skim_out <- skim(dat))\n\n# Ditch vars that are > 50% missing\nmis <- skim_out %>% \n  filter(complete_rate < 0.5) %>% \n  pull(skim_variable)\ndat <- select(dat, -any_of(mis))\nget_str(dat)\n# Noice\n```\n:::\n\n\n\n## Toy Example\n\nMake a mini version of data to play with, just go through the motions\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmini <- dat %>% \n  select(\n    gini, \n    ftmProdRatio, \n    cropDiversity,\n    farmIncomePF,\n    medianAcresPF\n  )\n```\n:::\n\n\n\nNote that we have a few missing values to deal with.\n\n### Preprocessing\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Discretize continuous variables. Not sure why we'd really want this though\ndiscretize(mini) \n\n# Remove highly correlated variables\ndedup(mini) \n# Not removing anything for our small set apparently\n```\n:::\n\n\n\n### Imputation\n\nImpute missing values based on specified DAG.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag <- model2network(\"[gini][ftmProdRatio|medianAcresPF][cropDiversity|gini:medianAcresPF][farmIncomePF|gini][medianAcresPF|gini:farmIncomePF]\")\ndfitted = bn.fit(dag, mini)\nimp <- impute(dfitted, data = mini, method = 'bayes-lw') # or parents\n```\n:::\n\n\n\n### Structural Learning\n\nUse imputed dataset for structural learning\n\n#### Constraint Based\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_pc <- pc.stable(imp) # PC\ndag_gs <- gs(imp) # Grow-Shrink\ndag_iamb <- iamb(imp) # Incremental Association\ndag_inter_iamb <- inter.iamb(imp) # Interleaved Incremental Association\n# and others\n\n# Plot one\nplot(dag_pc)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-4-1.png){width=1400}\n:::\n:::\n\n\n\nCompare outputs:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndags <- mget(c('dag_pc', 'dag_gs', 'dag_iamb', 'dag_inter_iamb'))\nscores <- map_dbl(dags, ~ score(.x, imp)) %>%  \n  bind_cols() %>% \n  mutate(names(dags), .before = everything()) %>% \n  setNames(c('model', 'bic'))\nknitr::kable(scores)\n```\n\n::: {.cell-output-display}\n\n\n|model          |       bic|\n|:--------------|---------:|\n|dag_pc         | -827.6263|\n|dag_gs         | -827.6263|\n|dag_iamb       | -827.6263|\n|dag_inter_iamb | -827.6263|\n\n\n:::\n:::\n\n\n\n\n#### Score Based\n\nWith hill climbing algorithm:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag <- hc(imp)\nprint(dag)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  Bayesian network learned via Score-based methods\n\n  model:\n   [cropDiversity][farmIncomePF][medianAcresPF|farmIncomePF][gini|medianAcresPF]\n   [ftmProdRatio|gini:cropDiversity:medianAcresPF]\n  nodes:                                 5 \n  arcs:                                  5 \n    undirected arcs:                     0 \n    directed arcs:                       5 \n  average markov blanket size:           2.80 \n  average neighbourhood size:            2.00 \n  average branching factor:              1.00 \n\n  learning algorithm:                    Hill-Climbing \n  score:                                 BIC (Gauss.) \n  penalization coefficient:              2.038769 \n  tests used in the learning procedure:  30 \n  optimized:                             TRUE \n```\n\n\n:::\n:::\n\n\n\nIn output, each node is shown in brackets with its parents after the pipe, separated by colons.\n\nPlot it:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(dag)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-7-1.png){width=1400}\n:::\n:::\n\n\n\n##### Whitelists and Blacklists\n\nUsing prior knowledge to set some constraints in structural learning. Let's say that $ftmProdRatio \\rightarrow cropDiversity$ and $gini \\rightarrow medianAcresPF$. Score-based algorithms have no undirected arcs, only directed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Whitelist\nwl = data.frame(\n  from = c('ftmProdRatio', 'gini'),\n  to = c('cropDiversity', 'medianAcresPF')\n)\n\ndag_cons <- hc(imp, whitelist = wl)\nplot(\n  dag_cons,\n  highlight = c('gini'),\n  color = 'royalblue'\n)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-8-1.png){width=1400}\n:::\n:::\n\n\n\n### Plotting\n\nHighlight Markov Blanket for gini\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(\n  dag_cons,\n  highlight = c('gini', mb(dag_cons, 'gini')),\n  color = 'royalblue'\n)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-9-1.png){width=1400}\n:::\n:::\n\n\n\nMore plotting options with graphviz:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraphviz.plot(\n  dag_cons,\n  shape = 'ellipse',\n  fontsize = 10,\n  main = 'Wicked DAG',\n  sub = 'Subtitle for Wicked DAG',\n  layout = 'neato'\n)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-10-1.png){width=1400}\n:::\n:::\n\n\n\n\n### Parameter Learning\n\nAKA fitting the model. We can use `method = 'bayes'` for discrete data only. Otherwise it is using maximum likelihood. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(fitted <- bn.fit(dag, imp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  Bayesian network parameters\n\n  Parameters of node gini (Gaussian distribution)\n\nConditional density: gini | medianAcresPF\nCoefficients:\n  (Intercept)  medianAcresPF  \n 0.4639066334  -0.0002200612  \nStandard deviation of the residuals: 0.02635921 \n\n  Parameters of node ftmProdRatio (Gaussian distribution)\n\nConditional density: ftmProdRatio | gini + cropDiversity + medianAcresPF\nCoefficients:\n  (Intercept)           gini  cropDiversity  medianAcresPF  \n -0.020025383    2.237925194   -0.179204416   -0.001608439  \nStandard deviation of the residuals: 0.1109027 \n\n  Parameters of node cropDiversity (Gaussian distribution)\n\nConditional density: cropDiversity\nCoefficients:\n(Intercept)  \n  0.7714477  \nStandard deviation of the residuals: 0.353584 \n\n  Parameters of node farmIncomePF (Gaussian distribution)\n\nConditional density: farmIncomePF\nCoefficients:\n(Intercept)  \n    28488.9  \nStandard deviation of the residuals: 19575.18 \n\n  Parameters of node medianAcresPF (Gaussian distribution)\n\nConditional density: medianAcresPF | farmIncomePF\nCoefficients:\n  (Intercept)   farmIncomePF  \n67.0929061273  -0.0006886306  \nStandard deviation of the residuals: 31.03801 \n```\n\n\n:::\n:::\n\n\n\nCoefficients are $\\beta$s. \n\n### Extract\n\nPull various outputs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Methods\n# AIC, BIC, plot, as.igrpah, as.lm, as.graphAM, as.grpahNEL\n# coef, degree, fitted, logLik, nodes, print, residuals, score\n\n# Coefficients (LM coefs for continuous data)\ncoef(fitted)\n\n# Residuals, fitted values\nresiduals(fitted)\nfitted.values(fitted)\n\n# log likelihood\nlogLik(dag, imp)\n\n# sigma - standard deviations of residuals\nsigma(fitted)\n```\n:::\n\n\n\n\n### Evaluate Model\n\nResidual plots:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbn.fit.qqplot(fitted)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-13-1.png){width=1400}\n:::\n:::\n\n\n\nLooks like we need to log transform income per farm.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbn.fit.xyplot(fitted)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-14-1.png){width=1400}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbn.fit.histogram(fitted)\n```\n\n::: {.cell-output-display}\n![](bnlearn_files/figure-html/unnamed-chunk-15-1.png){width=1400}\n:::\n:::\n\n\n\nAnd various stats:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Shannon entropy\nH(fitted)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 13.53725\n```\n\n\n:::\n\n```{.r .cell-code}\n# Kullback-Leibler divergence to copmare two fitted networks\n# KL(fitted)\n\n# Scores. Default is BIC\nscore(dag, imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -824.2792\n```\n\n\n:::\n\n```{.r .cell-code}\n# -g for gaussian (continuous) networks, -cg for hybrid\nscore(dag, imp, type = 'loglik-g')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -793.6977\n```\n\n\n:::\n\n```{.r .cell-code}\nscore(dag, imp, type = 'aic-g')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -808.6977\n```\n\n\n:::\n\n```{.r .cell-code}\nscore(dag, imp, type = 'bic-g')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -824.2792\n```\n\n\n:::\n\n```{.r .cell-code}\nscore(dag, imp, type = 'ebic-g') # additional penalty for dense networks\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -840.3736\n```\n\n\n:::\n\n```{.r .cell-code}\nscore(dag, imp, type = 'bge') # Gaussian posterior density\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -966.6152\n```\n\n\n:::\n\n```{.r .cell-code}\n# and others...\n```\n:::\n\n\n\n\n## State Data \n\nLet's try this with our aggregated indicators from the state data. Counties are a bit of a mess right now. \n\n### Preprocessing\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores <- readRDS('data/raw_minmax_geo.rds')\nget_str(scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nrowws_df [50 × 63] (S3: rowwise_df/tbl_df/tbl/data.frame)\n $ state                                      : chr [1:50] \"AL\" \"AK\" \"AZ\" \"AR\"..\n $ indic_access to land                       : num [1:50] 0.363 0.219 0.198 0..\n $ indic_wealth/income distribution           : num [1:50] 0.275 0.684 0.373 0..\n $ indic_income stability                     : num [1:50] 0.08724 0.06626 0.2..\n $ indic_operations diversification           : num [1:50] 0.013147 0.39392 0...\n $ indic_use of ag/farm/crop insurance        : num [1:50] 0.2314 0.21962 0 0...\n $ indic_carbon fluxes                        : num [1:50] 0.346 0.751 0.879 0..\n $ indic_carbon stocks                        : num [1:50] 0.1654 0.3674 0.018..\n $ indic_embodied carbon                      : num [1:50] 0.05821 0.00615 0.0..\n $ indic_forest health                        : num [1:50] 0.25 0.4275 0.1041 ..\n $ indic_biodiversity                         : num [1:50] 0.572 0.298 0.574 0..\n $ indic_land use diversity                   : num [1:50] 0.954307 0.587913 0..\n $ indic_sensitive or rare habitats           : num [1:50] 0.642 0.7319 0.6918..\n $ indic_water quality                        : num [1:50] 0.581 0.585 0.449 0..\n $ indic_water quantity                       : num [1:50] 0.712 0.915 0.42 0...\n $ indic_educational attainment               : num [1:50] 0.2323 0.4223 0.447..\n $ indic_access to culturally appropriate food: num [1:50] 0.1563 0.3824 0.081..\n $ indic_dietary quality                      : num [1:50] 0.36 0.352 0.352 0...\n $ indic_food access                          : num [1:50] 0.1684 0.2286 0.106..\n $ indic_food affordability                   : num [1:50] 0.498 0.526 0.35 0...\n $ indic_mental health tbd                    : num [1:50] 0.352 0.34 0.312 0...\n $ indic_access to care                       : num [1:50] 0.198 0.435 0.313 0..\n $ indic_housing supply and quality           : num [1:50] 0.621 0.616 0.633 0..\n $ indic_physical health tbd                  : num [1:50] 0.274 0.585 0.507 0..\n $ indic_total quantity exported              : num [1:50] 0.068031 0 0.068105..\n $ indic_production species diversity         : num [1:50] 0.5496 0.2917 0.653..\n $ indic_production inputs                    : num [1:50] 0.8 1 0.619 0.305 0..\n $ indic_total quantity food products         : num [1:50] 0.107721 0.000613 0..\n $ indic_total quantity forest products       : num [1:50] 0.635061 0.000087 0..\n $ indic_total quantity non-food ag products  : num [1:50] 0.19143 0.00143 0.0..\n $ indic_value added market                   : num [1:50] 0.01481 0.30841 0.0..\n $ indic_crop failure                         : num [1:50] 0.95 1 0.967 0.391 ..\n $ indic_social connectedness                 : num [1:50] 0.417 0.406 0.314 0..\n $ indic_community safety                     : num [1:50] 0.749 0.384 0.896 0..\n $ indic_diverse representation               : num [1:50] 0.45 0.53 0.638 0.3..\n $ indic_age diversity                        : num [1:50] 0.3774 0.7547 0.113..\n $ indic_gender diversity                     : num [1:50] 0.274 0.9229 1 0.48..\n $ indic_racial diversity                     : num [1:50] 0.28454 0.34292 0.8..\n $ indic_participatory governance             : num [1:50] 0.3192 0.514 0.4967..\n $ index_access to capital/credit             : num [1:50] 0.363 0.219 0.198 0..\n $ index_community economy                    : num [1:50] 0.275 0.684 0.373 0..\n $ index_food business resilience             : num [1:50] 0.0643 0.179 0.0834..\n $ index_carbon, ghg, nutrients               : num [1:50] 0.1493 0.1193 0.101..\n $ index_forest                               : num [1:50] 0.25 0.4275 0.1041 ..\n $ index_species and habitat                  : num [1:50] 0.705 0.5042 0.4883..\n $ index_water                                : num [1:50] 0.643 0.732 0.434 0..\n $ index_education                            : num [1:50] 0.2323 0.4223 0.447..\n $ index_food security                        : num [1:50] 0.262 0.357 0.181 0..\n $ index_mental health                        : num [1:50] 0.352 0.34 0.312 0...\n $ index_physical health                      : num [1:50] 0.323 0.54 0.465 0...\n $ index_imports vs exports                   : num [1:50] 0.068031 0 0.068105..\n $ index_production diversity                 : num [1:50] 0.5496 0.2917 0.653..\n $ index_production margins                   : num [1:50] 0.17305 0.00749 0.0..\n $ index_waste and losses                     : num [1:50] 0.95 1 0.967 0.391 ..\n $ index_community embeddedness               : num [1:50] 0.417 0.406 0.314 0..\n $ index_community livability                 : num [1:50] 0.5809 0.4514 0.756..\n $ index_food and farmworker diversity        : num [1:50] 0.3087 0.6205 0.453..\n $ index_food system governance               : num [1:50] 0.3192 0.514 0.4967..\n $ dimen_economics                            : num [1:50] 0.186 0.299 0.183 0..\n $ dimen_environment                          : num [1:50] 0.361 0.37 0.218 0...\n $ dimen_health                               : num [1:50] 0.288 0.408 0.329 0..\n $ dimen_production                           : num [1:50] 0.28 0.2702 0.1884 ..\n $ dimen_social                               : num [1:50] 0.393 0.492 0.481 0..\n```\n\n\n:::\n\n```{.r .cell-code}\ndf <- scores %>% \n  select(matches('^indic')) %>% \n  setNames(c(str_remove(names(.), 'indic_') %>% str_replace_all(' ', '_')))\nget_str(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nrowws_df [50 × 38] (S3: rowwise_df/tbl_df/tbl/data.frame)\n $ access_to_land                       : num [1:50] 0.363 0.219 0.198 0.435 0..\n $ wealth/income_distribution           : num [1:50] 0.275 0.684 0.373 0.328 0..\n $ income_stability                     : num [1:50] 0.08724 0.06626 0.20328 0..\n $ operations_diversification           : num [1:50] 0.013147 0.39392 0.05679 ..\n $ use_of_ag/farm/crop_insurance        : num [1:50] 0.2314 0.21962 0 0.29855 ..\n $ carbon_fluxes                        : num [1:50] 0.346 0.751 0.879 0.436 0..\n $ carbon_stocks                        : num [1:50] 0.1654 0.3674 0.0185 0.32..\n $ embodied_carbon                      : num [1:50] 0.05821 0.00615 0.06465 0..\n $ forest_health                        : num [1:50] 0.25 0.4275 0.1041 0.3586..\n $ biodiversity                         : num [1:50] 0.572 0.298 0.574 0.489 0..\n $ land_use_diversity                   : num [1:50] 0.954307 0.587913 0.29319..\n $ sensitive_or_rare_habitats           : num [1:50] 0.642 0.7319 0.6918 0.419..\n $ water_quality                        : num [1:50] 0.581 0.585 0.449 0.454 0..\n $ water_quantity                       : num [1:50] 0.712 0.915 0.42 0.791 0...\n $ educational_attainment               : num [1:50] 0.2323 0.4223 0.4479 0.15..\n $ access_to_culturally_appropriate_food: num [1:50] 0.1563 0.3824 0.0818 0.07..\n $ dietary_quality                      : num [1:50] 0.36 0.352 0.352 0.768 0...\n $ food_access                          : num [1:50] 0.1684 0.2286 0.1061 0.12..\n $ food_affordability                   : num [1:50] 0.498 0.526 0.35 0.172 0...\n $ mental_health_tbd                    : num [1:50] 0.352 0.34 0.312 0.339 0...\n $ access_to_care                       : num [1:50] 0.198 0.435 0.313 0.247 0..\n $ housing_supply_and_quality           : num [1:50] 0.621 0.616 0.633 0.536 0..\n $ physical_health_tbd                  : num [1:50] 0.274 0.585 0.507 0.377 0..\n $ total_quantity_exported              : num [1:50] 0.068031 0 0.068105 0.174..\n $ production_species_diversity         : num [1:50] 0.5496 0.2917 0.6537 0.37..\n $ production_inputs                    : num [1:50] 0.8 1 0.619 0.305 0.533 0..\n $ total_quantity_food_products         : num [1:50] 0.107721 0.000613 0.07753..\n $ total_quantity_forest_products       : num [1:50] 0.635061 0.000087 0.00048..\n $ total_quantity_non-food_ag_products  : num [1:50] 0.19143 0.00143 0.02043 0..\n $ value_added_market                   : num [1:50] 0.01481 0.30841 0.04466 0..\n $ crop_failure                         : num [1:50] 0.95 1 0.967 0.391 0.636 ..\n $ social_connectedness                 : num [1:50] 0.417 0.406 0.314 0.388 0..\n $ community_safety                     : num [1:50] 0.749 0.384 0.896 0.677 0..\n $ diverse_representation               : num [1:50] 0.45 0.53 0.638 0.34 0.41..\n $ age_diversity                        : num [1:50] 0.3774 0.7547 0.1132 0.58..\n $ gender_diversity                     : num [1:50] 0.274 0.9229 1 0.4825 0.4..\n $ racial_diversity                     : num [1:50] 0.28454 0.34292 0.82326 0..\n $ participatory_governance             : num [1:50] 0.3192 0.514 0.4967 0.011..\n```\n\n\n:::\n\n```{.r .cell-code}\n# Get rid of county, also FFF variables\n# get_str(dat)\n# df <- dat %>% \n#   select(-any_of(c('fips', matches('FFF$'))))\n# get_str(df)\n\n# Remove highly correlated variables\nthreshold <- 0.5\ndf <- dedup(df, threshold = threshold)\nnames(df) <- snakecase::to_title_case(names(df))\n```\n:::\n\n\n\nThreshold of correlations at 0.5 brings us down from 58 variables to 21 variables.\n\n### Structural Learning\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodels <- list(\n  dag_pc = pc.stable(df),\n  dag_gs = gs(df),\n  dag_iamb = iamb(df),\n  dag_inter_iamb = inter.iamb(df),\n  dag_hc = hc(df),\n  dag_mmhc = mmhc(df)\n)\n# map(models, ~ try(score(.x, df)))\n```\n:::\n\n\n\nFirst try:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npng(\n  'temp/conferences/bnlearn.png',\n  width = 8,\n  height = 4,\n  units = 'in',\n  res = 400\n)\nset.seed(42)\ngraphviz.plot(\n  models$dag_hc,\n  layout = 'fdp',\n  shape = 'rectangle',\n  fontsize = 24,\n  # main = 'Bayesian Network Learning',\n  # sub = 'Hill-Climbing Algorithm, Force-Directed Layout',\n  highlight = list(\n    nodes = rbind('Food Affordability', mb(models$dag_hc, 'Food Affordability')),\n    arcs = outgoing.arcs(models$dag_hc, \"Food Affordability\"),\n    fill = 'lightblue',\n    col = \"darkblue\",\n    lwd = 2.5,\n    lty = 'dashed'\n  )\n)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npng \n  2 \n```\n\n\n:::\n:::\n\n\n\nSecond round, no colors\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag <- models$dag_hc\n\n# Convert to graphNEL\ngNEL <- as.graphNEL(dag)\n\n# Set node attributes\npadded_labels <- setNames(\n  paste0(\"              \", graph::nodes(gNEL), \"               \"),\n  graph::nodes(gNEL)\n)\nnAttrs <- list(label = padded_labels)\n\nnAttrs$width <- rep(\"2.75\", length(graph::nodes(gNEL)))\nnames(nAttrs$width) <- graph::nodes(gNEL)\n# # \nnAttrs$height <- rep(\"1.25\", length(graph::nodes(gNEL)))\nnames(nAttrs$height) <- graph::nodes(gNEL)\n\n# Font size\ngraphAttrs <- list(\n  node = list(\n    fontsize = \"24\", \n    shape = \"rectangle\", \n    fixedsize = 'false'\n  )\n)\n\n# Layout and render\nlayout <- layoutGraph(gNEL,\n                      layoutType = \"fdp\",\n                      nodeAttrs = nAttrs,\n                      attrs = graphAttrs)\n\n# Plot and save it\npng(\n  'temp/conferences/bnlearn.png',\n  width = 8,\n  height = 4,\n  units = 'in',\n  res = 500\n)\nrenderGraph(layout)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npng \n  2 \n```\n\n\n:::\n:::\n\n\n\nVersion with highlighted markov blanket for food access. This one for conference:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag <- models$dag_hc \n\n# Convert to graphNEL\ngNEL <- as.graphNEL(dag)\n\n# Pick a target node\ntarget <- \"Food Access\"\n\n# Get Markov blanket of the node\nmb_nodes <- mb(dag, target)\n\n# Do target too\nhighlight_nodes <- c(target, mb_nodes)\n\n# Edges\nall_edges <- edgeNames(gNEL)\neColors <- setNames(rep(\"black\", length(all_edges)), all_edges)\n\neAttrs <- list(color = eColors)\n\n# Set up labels and dimensions\nall_nodes <- graph::nodes(gNEL)\n\nnAttrs <- list(\n  label = setNames(paste0(\"              \", all_nodes, \"               \"), all_nodes),\n  width = setNames(rep(\"2.75\", length(all_nodes)), all_nodes),\n  height = setNames(rep(\"1.25\", length(all_nodes)), all_nodes),\n  fillcolor = setNames(rep(\"white\", length(all_nodes)), all_nodes)\n)\n\n# Highlight Markov blanket nodes\nnAttrs$fillcolor[highlight_nodes] <- \"skyblue3\"\nnAttrs$fillcolor[\"Food Access\"] <- \"lightblue\"\n\n# Set graph attributes\ngraphAttrs <- list(\n  node = list(\n    fontsize = \"24\",\n    shape = \"rectangle\",\n    fixedsize = \"false\",\n    style = \"filled\"\n  )\n)\n\n# Layout and plot\nlayout <- layoutGraph(gNEL,\n                      layoutType = \"fdp\",\n                      nodeAttrs = nAttrs,\n                      edgeAttrs = eAttrs,\n                      attrs = graphAttrs)\n\npng('temp/conferences/bnlearn_markov_blanket.png',\nwidth = 8, height = 4, units = 'in', res = 500)\nrenderGraph(layout)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npng \n  2 \n```\n\n\n:::\n:::\n\n\n\n### Parameter Learning\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(fitted <- bn.fit(models$dag_hc, df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  Bayesian network parameters\n\n  Parameters of node Access to Land (Gaussian distribution)\n\nConditional density: Access to Land | Operations Diversification + Use of Ag Farm Crop Insurance\nCoefficients:\n                  (Intercept)     Operations Diversification  \n                    0.3678407                      0.2160209  \nUse of Ag Farm Crop Insurance  \n                    0.1017920  \nStandard deviation of the residuals: 0.0949194 \n\n  Parameters of node Wealth Income Distribution (Gaussian distribution)\n\nConditional density: Wealth Income Distribution | Educational Attainment + Food Access + Food Affordability + Age Diversity\nCoefficients:\n           (Intercept)  Educational Attainment             Food Access  \n             0.1681083               0.2373968              -0.2454930  \n    Food Affordability           Age Diversity  \n             0.2108662               0.1672215  \nStandard deviation of the residuals: 0.0785374 \n\n  Parameters of node Income Stability (Gaussian distribution)\n\nConditional density: Income Stability | Land Use Diversity + Production Inputs\nCoefficients:\n       (Intercept)  Land Use Diversity   Production Inputs  \n         0.4654260          -0.1480142          -0.3033175  \nStandard deviation of the residuals: 0.1457618 \n\n  Parameters of node Operations Diversification (Gaussian distribution)\n\nConditional density: Operations Diversification | Food Affordability + Housing Supply and Quality\nCoefficients:\n               (Intercept)          Food Affordability  \n                 0.1257016                   0.7390683  \nHousing Supply and Quality  \n                -0.5268073  \nStandard deviation of the residuals: 0.1892199 \n\n  Parameters of node Use of Ag Farm Crop Insurance (Gaussian distribution)\n\nConditional density: Use of Ag Farm Crop Insurance\nCoefficients:\n(Intercept)  \n  0.2908146  \nStandard deviation of the residuals: 0.3258347 \n\n  Parameters of node Carbon Stocks (Gaussian distribution)\n\nConditional density: Carbon Stocks | Land Use Diversity + Food Access\nCoefficients:\n       (Intercept)  Land Use Diversity         Food Access  \n         0.2861762          -0.1269345           0.4109883  \nStandard deviation of the residuals: 0.1292551 \n\n  Parameters of node Biodiversity (Gaussian distribution)\n\nConditional density: Biodiversity | Wealth Income Distribution + Diverse Representation\nCoefficients:\n               (Intercept)  Wealth Income Distribution  \n                 0.7530572                  -0.4655309  \n    Diverse Representation  \n                -0.1574596  \nStandard deviation of the residuals: 0.08856775 \n\n  Parameters of node Land Use Diversity (Gaussian distribution)\n\nConditional density: Land Use Diversity\nCoefficients:\n(Intercept)  \n  0.5993155  \nStandard deviation of the residuals: 0.3398952 \n\n  Parameters of node Water Quality (Gaussian distribution)\n\nConditional density: Water Quality | Carbon Stocks + Production Inputs + Total Quantity Forest Products\nCoefficients:\n                   (Intercept)                   Carbon Stocks  \n                     0.1917051                       0.4404060  \n             Production Inputs  Total Quantity Forest Products  \n                     0.2276936                       0.2097693  \nStandard deviation of the residuals: 0.1180976 \n\n  Parameters of node Water Quantity (Gaussian distribution)\n\nConditional density: Water Quantity\nCoefficients:\n(Intercept)  \n  0.6892489  \nStandard deviation of the residuals: 0.1487077 \n\n  Parameters of node Educational Attainment (Gaussian distribution)\n\nConditional density: Educational Attainment | Operations Diversification + Food Access + Housing Supply and Quality + Production Species Diversity\nCoefficients:\n                 (Intercept)    Operations Diversification  \n                  -0.3289818                     0.5741352  \n                 Food Access    Housing Supply and Quality  \n                   0.6001153                     0.6597552  \nProduction Species Diversity  \n                   0.3977803  \nStandard deviation of the residuals: 0.1607495 \n\n  Parameters of node Dietary Quality (Gaussian distribution)\n\nConditional density: Dietary Quality | Educational Attainment + Total Quantity Forest Products\nCoefficients:\n                   (Intercept)          Educational Attainment  \n                     0.2653414                       0.3502134  \nTotal Quantity Forest Products  \n                     0.2756628  \nStandard deviation of the residuals: 0.1619697 \n\n  Parameters of node Food Access (Gaussian distribution)\n\nConditional density: Food Access | Food Affordability + Housing Supply and Quality + Diverse Representation\nCoefficients:\n               (Intercept)          Food Affordability  \n                 0.4659164                   0.4794728  \nHousing Supply and Quality      Diverse Representation  \n                -0.3907265                  -0.3524157  \nStandard deviation of the residuals: 0.1270123 \n\n  Parameters of node Food Affordability (Gaussian distribution)\n\nConditional density: Food Affordability | Age Diversity\nCoefficients:\n  (Intercept)  Age Diversity  \n    0.3995713      0.1617813  \nStandard deviation of the residuals: 0.1199753 \n\n  Parameters of node Housing Supply and Quality (Gaussian distribution)\n\nConditional density: Housing Supply and Quality\nCoefficients:\n(Intercept)  \n   0.632082  \nStandard deviation of the residuals: 0.1658251 \n\n  Parameters of node Production Species Diversity (Gaussian distribution)\n\nConditional density: Production Species Diversity | Income Stability + Food Affordability\nCoefficients:\n       (Intercept)    Income Stability  Food Affordability  \n         0.5772241           0.5095608          -0.4979768  \nStandard deviation of the residuals: 0.1766347 \n\n  Parameters of node Production Inputs (Gaussian distribution)\n\nConditional density: Production Inputs | Operations Diversification + Diverse Representation\nCoefficients:\n               (Intercept)  Operations Diversification  \n                 0.4025243                   0.4323048  \n    Diverse Representation  \n                 0.3383928  \nStandard deviation of the residuals: 0.2032092 \n\n  Parameters of node Total Quantity Forest Products (Gaussian distribution)\n\nConditional density: Total Quantity Forest Products | Carbon Stocks + Biodiversity + Land Use Diversity\nCoefficients:\n       (Intercept)       Carbon Stocks        Biodiversity  Land Use Diversity  \n        -0.5635779           0.3859885           0.9925765           0.2523607  \nStandard deviation of the residuals: 0.179978 \n\n  Parameters of node Community Safety (Gaussian distribution)\n\nConditional density: Community Safety | Wealth Income Distribution\nCoefficients:\n               (Intercept)  Wealth Income Distribution  \n                 1.0132669                  -0.9813018  \nStandard deviation of the residuals: 0.1907941 \n\n  Parameters of node Diverse Representation (Gaussian distribution)\n\nConditional density: Diverse Representation\nCoefficients:\n(Intercept)  \n   0.484942  \nStandard deviation of the residuals: 0.1905229 \n\n  Parameters of node Age Diversity (Gaussian distribution)\n\nConditional density: Age Diversity | Water Quantity + Housing Supply and Quality + Diverse Representation\nCoefficients:\n               (Intercept)              Water Quantity  \n                0.06324201                  0.37829722  \nHousing Supply and Quality      Diverse Representation  \n                0.59421855                 -0.42866922  \nStandard deviation of the residuals: 0.1914163 \n```\n\n\n:::\n:::\n\n\n\nBootstrap how many arcs we get:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunlist(bn.boot(df, statistic = narcs, algorithm = \"hc\", R = 10))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 55 52 57 67 54 59 48 58 56 53\n```\n\n\n:::\n:::\n\n\n\nDummy models:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbn.boot(df, statistic = function(x) x, algorithm = \"hc\", R = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n\n  Bayesian network learned via Score-based methods\n\n  model:\n   [Use of Ag Farm Crop Insurance][Land Use Diversity]\n   [Water Quality|Use of Ag Farm Crop Insurance][Dietary Quality|Water Quality]\n   [Income Stability|Dietary Quality]\n   [Operations Diversification|Income Stability]\n   [Biodiversity|Operations Diversification]\n   [Food Affordability|Biodiversity:Land Use Diversity:Water Quality]\n   [Educational Attainment|Water Quality:Food Affordability]\n   [Wealth Income Distribution|Biodiversity:Educational Attainment:Dietary Quality:Food Affordability]\n   [Total Quantity Forest Products|Use of Ag Farm Crop Insurance:Biodiversity:Educational Attainment:Dietary Quality]\n   [Food Access|Use of Ag Farm Crop Insurance:Educational Attainment:Total Quantity Forest Products]\n   [Carbon Stocks|Water Quality:Food Access][Water Quantity|Food Access]\n   [Access to Land|Income Stability:Operations Diversification:Carbon Stocks:Water Quality:Water Quantity]\n   [Production Species Diversity|Income Stability:Carbon Stocks:Water Quality:Water Quantity:Dietary Quality:Food Affordability]\n   [Production Inputs|Operations Diversification:Carbon Stocks:Water Quality]\n   [Housing Supply and Quality|Access to Land:Wealth Income Distribution:Operations Diversification:Biodiversity:Educational Attainment:Production Species Diversity]\n   [Community Safety|Wealth Income Distribution:Housing Supply and Quality]\n   [Age Diversity|Water Quantity:Housing Supply and Quality]\n   [Diverse Representation|Operations Diversification:Biodiversity:Production Inputs:Age Diversity]\n  nodes:                                 21 \n  arcs:                                  52 \n    undirected arcs:                     0 \n    directed arcs:                       52 \n  average markov blanket size:           8.67 \n  average neighbourhood size:            4.95 \n  average branching factor:              2.48 \n\n  learning algorithm:                    Hill-Climbing \n  score:                                 BIC (Gauss.) \n  penalization coefficient:              1.956012 \n  tests used in the learning procedure:  1370 \n  optimized:                             TRUE \n\n\n[[2]]\n\n  Bayesian network learned via Score-based methods\n\n  model:\n   [Wealth Income Distribution][Land Use Diversity][Water Quality]\n   [Water Quantity|Land Use Diversity]\n   [Dietary Quality|Land Use Diversity:Water Quality]\n   [Community Safety|Wealth Income Distribution][Carbon Stocks|Dietary Quality]\n   [Food Affordability|Wealth Income Distribution:Dietary Quality]\n   [Use of Ag Farm Crop Insurance|Carbon Stocks]\n   [Production Species Diversity|Water Quantity:Food Affordability]\n   [Income Stability|Carbon Stocks:Land Use Diversity:Production Species Diversity]\n   [Access to Land|Income Stability:Carbon Stocks:Community Safety]\n   [Food Access|Access to Land:Carbon Stocks]\n   [Production Inputs|Access to Land:Income Stability:Land Use Diversity:Food Affordability:Production Species Diversity:Community Safety]\n   [Educational Attainment|Wealth Income Distribution:Land Use Diversity:Food Access:Production Species Diversity]\n   [Operations Diversification|Access to Land:Educational Attainment:Production Inputs:Community Safety]\n   [Total Quantity Forest Products|Income Stability:Land Use Diversity:Water Quality:Educational Attainment:Food Affordability:Community Safety]\n   [Biodiversity|Operations Diversification:Use of Ag Farm Crop Insurance:Water Quantity:Total Quantity Forest Products]\n   [Housing Supply and Quality|Wealth Income Distribution:Income Stability:Operations Diversification]\n   [Diverse Representation|Biodiversity:Food Access:Production Inputs:Community Safety]\n   [Age Diversity|Wealth Income Distribution:Operations Diversification:Use of Ag Farm Crop Insurance:Land Use Diversity:Educational Attainment:Food Access:Housing Supply and Quality:Community Safety]\n  nodes:                                 21 \n  arcs:                                  57 \n    undirected arcs:                     0 \n    directed arcs:                       57 \n  average markov blanket size:           10.76 \n  average neighbourhood size:            5.43 \n  average branching factor:              2.71 \n\n  learning algorithm:                    Hill-Climbing \n  score:                                 BIC (Gauss.) \n  penalization coefficient:              1.956012 \n  tests used in the learning procedure:  1390 \n  optimized:                             TRUE \n```\n\n\n:::\n:::\n\n\n\nArc strength: confidence in a particular graphical feature of network. Bootstraps network, then estimates relative frequency of parameter of interest. Gets strength of every possible arc. Strength shows probability of the arc existing, Direction shows probability of it being the direction shown.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\narc_str <- boot.strength(df, algorithm = \"hc\")\narc_str\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                              from                             to strength\n1                   Access to Land     Wealth Income Distribution    0.110\n2                   Access to Land               Income Stability    0.210\n3                   Access to Land     Operations Diversification    0.750\n4                   Access to Land  Use of Ag Farm Crop Insurance    0.615\n5                   Access to Land                  Carbon Stocks    0.200\n6                   Access to Land                   Biodiversity    0.160\n7                   Access to Land             Land Use Diversity    0.085\n8                   Access to Land                  Water Quality    0.310\n9                   Access to Land                 Water Quantity    0.130\n10                  Access to Land         Educational Attainment    0.140\n11                  Access to Land                Dietary Quality    0.250\n12                  Access to Land                    Food Access    0.190\n13                  Access to Land             Food Affordability    0.090\n14                  Access to Land     Housing Supply and Quality    0.115\n15                  Access to Land   Production Species Diversity    0.060\n16                  Access to Land              Production Inputs    0.090\n17                  Access to Land Total Quantity Forest Products    0.090\n18                  Access to Land               Community Safety    0.090\n19                  Access to Land         Diverse Representation    0.125\n20                  Access to Land                  Age Diversity    0.150\n21      Wealth Income Distribution                 Access to Land    0.110\n22      Wealth Income Distribution               Income Stability    0.175\n23      Wealth Income Distribution     Operations Diversification    0.240\n24      Wealth Income Distribution  Use of Ag Farm Crop Insurance    0.205\n25      Wealth Income Distribution                  Carbon Stocks    0.035\n26      Wealth Income Distribution                   Biodiversity    0.645\n27      Wealth Income Distribution             Land Use Diversity    0.200\n28      Wealth Income Distribution                  Water Quality    0.095\n29      Wealth Income Distribution                 Water Quantity    0.095\n30      Wealth Income Distribution         Educational Attainment    0.745\n31      Wealth Income Distribution                Dietary Quality    0.130\n32      Wealth Income Distribution                    Food Access    0.105\n33      Wealth Income Distribution             Food Affordability    0.355\n34      Wealth Income Distribution     Housing Supply and Quality    0.560\n35      Wealth Income Distribution   Production Species Diversity    0.155\n36      Wealth Income Distribution              Production Inputs    0.205\n37      Wealth Income Distribution Total Quantity Forest Products    0.395\n38      Wealth Income Distribution               Community Safety    0.720\n39      Wealth Income Distribution         Diverse Representation    0.080\n40      Wealth Income Distribution                  Age Diversity    0.610\n41                Income Stability                 Access to Land    0.210\n42                Income Stability     Wealth Income Distribution    0.175\n43                Income Stability     Operations Diversification    0.670\n44                Income Stability  Use of Ag Farm Crop Insurance    0.200\n45                Income Stability                  Carbon Stocks    0.125\n46                Income Stability                   Biodiversity    0.135\n47                Income Stability             Land Use Diversity    0.300\n48                Income Stability                  Water Quality    0.245\n49                Income Stability                 Water Quantity    0.125\n50                Income Stability         Educational Attainment    0.175\n51                Income Stability                Dietary Quality    0.205\n52                Income Stability                    Food Access    0.375\n53                Income Stability             Food Affordability    0.070\n54                Income Stability     Housing Supply and Quality    0.280\n55                Income Stability   Production Species Diversity    0.770\n56                Income Stability              Production Inputs    0.535\n57                Income Stability Total Quantity Forest Products    0.085\n58                Income Stability               Community Safety    0.140\n59                Income Stability         Diverse Representation    0.055\n60                Income Stability                  Age Diversity    0.075\n61      Operations Diversification                 Access to Land    0.750\n62      Operations Diversification     Wealth Income Distribution    0.240\n63      Operations Diversification               Income Stability    0.670\n64      Operations Diversification  Use of Ag Farm Crop Insurance    0.140\n65      Operations Diversification                  Carbon Stocks    0.090\n66      Operations Diversification                   Biodiversity    0.350\n67      Operations Diversification             Land Use Diversity    0.290\n68      Operations Diversification                  Water Quality    0.210\n69      Operations Diversification                 Water Quantity    0.165\n70      Operations Diversification         Educational Attainment    0.705\n71      Operations Diversification                Dietary Quality    0.170\n72      Operations Diversification                    Food Access    0.215\n73      Operations Diversification             Food Affordability    0.530\n74      Operations Diversification     Housing Supply and Quality    0.845\n75      Operations Diversification   Production Species Diversity    0.265\n76      Operations Diversification              Production Inputs    0.700\n77      Operations Diversification Total Quantity Forest Products    0.175\n78      Operations Diversification               Community Safety    0.350\n79      Operations Diversification         Diverse Representation    0.175\n80      Operations Diversification                  Age Diversity    0.255\n81   Use of Ag Farm Crop Insurance                 Access to Land    0.615\n82   Use of Ag Farm Crop Insurance     Wealth Income Distribution    0.205\n83   Use of Ag Farm Crop Insurance               Income Stability    0.200\n84   Use of Ag Farm Crop Insurance     Operations Diversification    0.140\n85   Use of Ag Farm Crop Insurance                  Carbon Stocks    0.125\n86   Use of Ag Farm Crop Insurance                   Biodiversity    0.280\n87   Use of Ag Farm Crop Insurance             Land Use Diversity    0.265\n88   Use of Ag Farm Crop Insurance                  Water Quality    0.385\n89   Use of Ag Farm Crop Insurance                 Water Quantity    0.190\n90   Use of Ag Farm Crop Insurance         Educational Attainment    0.195\n91   Use of Ag Farm Crop Insurance                Dietary Quality    0.055\n92   Use of Ag Farm Crop Insurance                    Food Access    0.160\n93   Use of Ag Farm Crop Insurance             Food Affordability    0.045\n94   Use of Ag Farm Crop Insurance     Housing Supply and Quality    0.155\n95   Use of Ag Farm Crop Insurance   Production Species Diversity    0.050\n96   Use of Ag Farm Crop Insurance              Production Inputs    0.320\n97   Use of Ag Farm Crop Insurance Total Quantity Forest Products    0.235\n98   Use of Ag Farm Crop Insurance               Community Safety    0.135\n99   Use of Ag Farm Crop Insurance         Diverse Representation    0.145\n100  Use of Ag Farm Crop Insurance                  Age Diversity    0.230\n101                  Carbon Stocks                 Access to Land    0.200\n102                  Carbon Stocks     Wealth Income Distribution    0.035\n103                  Carbon Stocks               Income Stability    0.125\n104                  Carbon Stocks     Operations Diversification    0.090\n105                  Carbon Stocks  Use of Ag Farm Crop Insurance    0.125\n106                  Carbon Stocks                   Biodiversity    0.085\n107                  Carbon Stocks             Land Use Diversity    0.495\n108                  Carbon Stocks                  Water Quality    0.855\n109                  Carbon Stocks                 Water Quantity    0.060\n110                  Carbon Stocks         Educational Attainment    0.125\n111                  Carbon Stocks                Dietary Quality    0.245\n112                  Carbon Stocks                    Food Access    0.885\n113                  Carbon Stocks             Food Affordability    0.140\n114                  Carbon Stocks     Housing Supply and Quality    0.245\n115                  Carbon Stocks   Production Species Diversity    0.160\n116                  Carbon Stocks              Production Inputs    0.240\n117                  Carbon Stocks Total Quantity Forest Products    0.285\n118                  Carbon Stocks               Community Safety    0.090\n119                  Carbon Stocks         Diverse Representation    0.130\n120                  Carbon Stocks                  Age Diversity    0.215\n121                   Biodiversity                 Access to Land    0.160\n122                   Biodiversity     Wealth Income Distribution    0.645\n123                   Biodiversity               Income Stability    0.135\n124                   Biodiversity     Operations Diversification    0.350\n125                   Biodiversity  Use of Ag Farm Crop Insurance    0.280\n126                   Biodiversity                  Carbon Stocks    0.085\n127                   Biodiversity             Land Use Diversity    0.045\n128                   Biodiversity                  Water Quality    0.290\n129                   Biodiversity                 Water Quantity    0.290\n130                   Biodiversity         Educational Attainment    0.085\n131                   Biodiversity                Dietary Quality    0.080\n132                   Biodiversity                    Food Access    0.295\n133                   Biodiversity             Food Affordability    0.255\n134                   Biodiversity     Housing Supply and Quality    0.325\n135                   Biodiversity   Production Species Diversity    0.515\n136                   Biodiversity              Production Inputs    0.440\n137                   Biodiversity Total Quantity Forest Products    0.790\n138                   Biodiversity               Community Safety    0.280\n139                   Biodiversity         Diverse Representation    0.605\n140                   Biodiversity                  Age Diversity    0.340\n141             Land Use Diversity                 Access to Land    0.085\n142             Land Use Diversity     Wealth Income Distribution    0.200\n143             Land Use Diversity               Income Stability    0.300\n144             Land Use Diversity     Operations Diversification    0.290\n145             Land Use Diversity  Use of Ag Farm Crop Insurance    0.265\n146             Land Use Diversity                  Carbon Stocks    0.495\n147             Land Use Diversity                   Biodiversity    0.045\n148             Land Use Diversity                  Water Quality    0.375\n149             Land Use Diversity                 Water Quantity    0.355\n150             Land Use Diversity         Educational Attainment    0.135\n151             Land Use Diversity                Dietary Quality    0.135\n152             Land Use Diversity                    Food Access    0.145\n153             Land Use Diversity             Food Affordability    0.470\n154             Land Use Diversity     Housing Supply and Quality    0.135\n155             Land Use Diversity   Production Species Diversity    0.420\n156             Land Use Diversity              Production Inputs    0.270\n157             Land Use Diversity Total Quantity Forest Products    0.660\n158             Land Use Diversity               Community Safety    0.130\n159             Land Use Diversity         Diverse Representation    0.105\n160             Land Use Diversity                  Age Diversity    0.085\n161                  Water Quality                 Access to Land    0.310\n162                  Water Quality     Wealth Income Distribution    0.095\n163                  Water Quality               Income Stability    0.245\n164                  Water Quality     Operations Diversification    0.210\n165                  Water Quality  Use of Ag Farm Crop Insurance    0.385\n166                  Water Quality                  Carbon Stocks    0.855\n167                  Water Quality                   Biodiversity    0.290\n168                  Water Quality             Land Use Diversity    0.375\n169                  Water Quality                 Water Quantity    0.110\n170                  Water Quality         Educational Attainment    0.065\n171                  Water Quality                Dietary Quality    0.350\n172                  Water Quality                    Food Access    0.070\n173                  Water Quality             Food Affordability    0.195\n174                  Water Quality     Housing Supply and Quality    0.125\n175                  Water Quality   Production Species Diversity    0.105\n176                  Water Quality              Production Inputs    0.385\n177                  Water Quality Total Quantity Forest Products    0.605\n178                  Water Quality               Community Safety    0.100\n179                  Water Quality         Diverse Representation    0.070\n180                  Water Quality                  Age Diversity    0.110\n181                 Water Quantity                 Access to Land    0.130\n182                 Water Quantity     Wealth Income Distribution    0.095\n183                 Water Quantity               Income Stability    0.125\n184                 Water Quantity     Operations Diversification    0.165\n185                 Water Quantity  Use of Ag Farm Crop Insurance    0.190\n186                 Water Quantity                  Carbon Stocks    0.060\n187                 Water Quantity                   Biodiversity    0.290\n188                 Water Quantity             Land Use Diversity    0.355\n189                 Water Quantity                  Water Quality    0.110\n190                 Water Quantity         Educational Attainment    0.265\n191                 Water Quantity                Dietary Quality    0.085\n192                 Water Quantity                    Food Access    0.180\n193                 Water Quantity             Food Affordability    0.130\n194                 Water Quantity     Housing Supply and Quality    0.250\n195                 Water Quantity   Production Species Diversity    0.335\n196                 Water Quantity              Production Inputs    0.035\n197                 Water Quantity Total Quantity Forest Products    0.315\n198                 Water Quantity               Community Safety    0.130\n199                 Water Quantity         Diverse Representation    0.070\n200                 Water Quantity                  Age Diversity    0.395\n201         Educational Attainment                 Access to Land    0.140\n202         Educational Attainment     Wealth Income Distribution    0.745\n203         Educational Attainment               Income Stability    0.175\n204         Educational Attainment     Operations Diversification    0.705\n205         Educational Attainment  Use of Ag Farm Crop Insurance    0.195\n206         Educational Attainment                  Carbon Stocks    0.125\n207         Educational Attainment                   Biodiversity    0.085\n208         Educational Attainment             Land Use Diversity    0.135\n209         Educational Attainment                  Water Quality    0.065\n210         Educational Attainment                 Water Quantity    0.265\n211         Educational Attainment                Dietary Quality    0.605\n212         Educational Attainment                    Food Access    0.940\n213         Educational Attainment             Food Affordability    0.275\n214         Educational Attainment     Housing Supply and Quality    0.375\n215         Educational Attainment   Production Species Diversity    0.365\n216         Educational Attainment              Production Inputs    0.115\n217         Educational Attainment Total Quantity Forest Products    0.350\n218         Educational Attainment               Community Safety    0.225\n219         Educational Attainment         Diverse Representation    0.070\n220         Educational Attainment                  Age Diversity    0.325\n221                Dietary Quality                 Access to Land    0.250\n222                Dietary Quality     Wealth Income Distribution    0.130\n223                Dietary Quality               Income Stability    0.205\n224                Dietary Quality     Operations Diversification    0.170\n225                Dietary Quality  Use of Ag Farm Crop Insurance    0.055\n226                Dietary Quality                  Carbon Stocks    0.245\n227                Dietary Quality                   Biodiversity    0.080\n228                Dietary Quality             Land Use Diversity    0.135\n229                Dietary Quality                  Water Quality    0.350\n230                Dietary Quality                 Water Quantity    0.085\n231                Dietary Quality         Educational Attainment    0.605\n232                Dietary Quality                    Food Access    0.220\n233                Dietary Quality             Food Affordability    0.335\n234                Dietary Quality     Housing Supply and Quality    0.080\n235                Dietary Quality   Production Species Diversity    0.180\n236                Dietary Quality              Production Inputs    0.155\n237                Dietary Quality Total Quantity Forest Products    0.460\n238                Dietary Quality               Community Safety    0.130\n239                Dietary Quality         Diverse Representation    0.075\n240                Dietary Quality                  Age Diversity    0.100\n241                    Food Access                 Access to Land    0.190\n242                    Food Access     Wealth Income Distribution    0.105\n243                    Food Access               Income Stability    0.375\n244                    Food Access     Operations Diversification    0.215\n245                    Food Access  Use of Ag Farm Crop Insurance    0.160\n246                    Food Access                  Carbon Stocks    0.885\n247                    Food Access                   Biodiversity    0.295\n248                    Food Access             Land Use Diversity    0.145\n249                    Food Access                  Water Quality    0.070\n250                    Food Access                 Water Quantity    0.180\n251                    Food Access         Educational Attainment    0.940\n252                    Food Access                Dietary Quality    0.220\n253                    Food Access             Food Affordability    0.640\n254                    Food Access     Housing Supply and Quality    0.690\n255                    Food Access   Production Species Diversity    0.245\n256                    Food Access              Production Inputs    0.080\n257                    Food Access Total Quantity Forest Products    0.140\n258                    Food Access               Community Safety    0.170\n259                    Food Access         Diverse Representation    0.665\n260                    Food Access                  Age Diversity    0.415\n261             Food Affordability                 Access to Land    0.090\n262             Food Affordability     Wealth Income Distribution    0.355\n263             Food Affordability               Income Stability    0.070\n264             Food Affordability     Operations Diversification    0.530\n265             Food Affordability  Use of Ag Farm Crop Insurance    0.045\n266             Food Affordability                  Carbon Stocks    0.140\n267             Food Affordability                   Biodiversity    0.255\n268             Food Affordability             Land Use Diversity    0.470\n269             Food Affordability                  Water Quality    0.195\n270             Food Affordability                 Water Quantity    0.130\n271             Food Affordability         Educational Attainment    0.275\n272             Food Affordability                Dietary Quality    0.335\n273             Food Affordability                    Food Access    0.640\n274             Food Affordability     Housing Supply and Quality    0.230\n275             Food Affordability   Production Species Diversity    0.465\n276             Food Affordability              Production Inputs    0.310\n277             Food Affordability Total Quantity Forest Products    0.090\n278             Food Affordability               Community Safety    0.145\n279             Food Affordability         Diverse Representation    0.105\n280             Food Affordability                  Age Diversity    0.260\n281     Housing Supply and Quality                 Access to Land    0.115\n282     Housing Supply and Quality     Wealth Income Distribution    0.560\n283     Housing Supply and Quality               Income Stability    0.280\n284     Housing Supply and Quality     Operations Diversification    0.845\n285     Housing Supply and Quality  Use of Ag Farm Crop Insurance    0.155\n286     Housing Supply and Quality                  Carbon Stocks    0.245\n287     Housing Supply and Quality                   Biodiversity    0.325\n288     Housing Supply and Quality             Land Use Diversity    0.135\n289     Housing Supply and Quality                  Water Quality    0.125\n290     Housing Supply and Quality                 Water Quantity    0.250\n291     Housing Supply and Quality         Educational Attainment    0.375\n292     Housing Supply and Quality                Dietary Quality    0.080\n293     Housing Supply and Quality                    Food Access    0.690\n294     Housing Supply and Quality             Food Affordability    0.230\n295     Housing Supply and Quality   Production Species Diversity    0.460\n296     Housing Supply and Quality              Production Inputs    0.135\n297     Housing Supply and Quality Total Quantity Forest Products    0.115\n298     Housing Supply and Quality               Community Safety    0.090\n299     Housing Supply and Quality         Diverse Representation    0.225\n300     Housing Supply and Quality                  Age Diversity    0.705\n301   Production Species Diversity                 Access to Land    0.060\n302   Production Species Diversity     Wealth Income Distribution    0.155\n303   Production Species Diversity               Income Stability    0.770\n304   Production Species Diversity     Operations Diversification    0.265\n305   Production Species Diversity  Use of Ag Farm Crop Insurance    0.050\n306   Production Species Diversity                  Carbon Stocks    0.160\n307   Production Species Diversity                   Biodiversity    0.515\n308   Production Species Diversity             Land Use Diversity    0.420\n309   Production Species Diversity                  Water Quality    0.105\n310   Production Species Diversity                 Water Quantity    0.335\n311   Production Species Diversity         Educational Attainment    0.365\n312   Production Species Diversity                Dietary Quality    0.180\n313   Production Species Diversity                    Food Access    0.245\n314   Production Species Diversity             Food Affordability    0.465\n315   Production Species Diversity     Housing Supply and Quality    0.460\n316   Production Species Diversity              Production Inputs    0.240\n317   Production Species Diversity Total Quantity Forest Products    0.145\n318   Production Species Diversity               Community Safety    0.110\n319   Production Species Diversity         Diverse Representation    0.100\n320   Production Species Diversity                  Age Diversity    0.310\n321              Production Inputs                 Access to Land    0.090\n322              Production Inputs     Wealth Income Distribution    0.205\n323              Production Inputs               Income Stability    0.535\n324              Production Inputs     Operations Diversification    0.700\n325              Production Inputs  Use of Ag Farm Crop Insurance    0.320\n326              Production Inputs                  Carbon Stocks    0.240\n327              Production Inputs                   Biodiversity    0.440\n328              Production Inputs             Land Use Diversity    0.270\n329              Production Inputs                  Water Quality    0.385\n330              Production Inputs                 Water Quantity    0.035\n331              Production Inputs         Educational Attainment    0.115\n332              Production Inputs                Dietary Quality    0.155\n333              Production Inputs                    Food Access    0.080\n334              Production Inputs             Food Affordability    0.310\n335              Production Inputs     Housing Supply and Quality    0.135\n336              Production Inputs   Production Species Diversity    0.240\n337              Production Inputs Total Quantity Forest Products    0.380\n338              Production Inputs               Community Safety    0.125\n339              Production Inputs         Diverse Representation    0.655\n340              Production Inputs                  Age Diversity    0.155\n341 Total Quantity Forest Products                 Access to Land    0.090\n342 Total Quantity Forest Products     Wealth Income Distribution    0.395\n343 Total Quantity Forest Products               Income Stability    0.085\n344 Total Quantity Forest Products     Operations Diversification    0.175\n345 Total Quantity Forest Products  Use of Ag Farm Crop Insurance    0.235\n346 Total Quantity Forest Products                  Carbon Stocks    0.285\n347 Total Quantity Forest Products                   Biodiversity    0.790\n348 Total Quantity Forest Products             Land Use Diversity    0.660\n349 Total Quantity Forest Products                  Water Quality    0.605\n350 Total Quantity Forest Products                 Water Quantity    0.315\n351 Total Quantity Forest Products         Educational Attainment    0.350\n352 Total Quantity Forest Products                Dietary Quality    0.460\n353 Total Quantity Forest Products                    Food Access    0.140\n354 Total Quantity Forest Products             Food Affordability    0.090\n355 Total Quantity Forest Products     Housing Supply and Quality    0.115\n356 Total Quantity Forest Products   Production Species Diversity    0.145\n357 Total Quantity Forest Products              Production Inputs    0.380\n358 Total Quantity Forest Products               Community Safety    0.450\n359 Total Quantity Forest Products         Diverse Representation    0.090\n360 Total Quantity Forest Products                  Age Diversity    0.125\n361               Community Safety                 Access to Land    0.090\n362               Community Safety     Wealth Income Distribution    0.720\n363               Community Safety               Income Stability    0.140\n364               Community Safety     Operations Diversification    0.350\n365               Community Safety  Use of Ag Farm Crop Insurance    0.135\n366               Community Safety                  Carbon Stocks    0.090\n367               Community Safety                   Biodiversity    0.280\n368               Community Safety             Land Use Diversity    0.130\n369               Community Safety                  Water Quality    0.100\n370               Community Safety                 Water Quantity    0.130\n371               Community Safety         Educational Attainment    0.225\n372               Community Safety                Dietary Quality    0.130\n373               Community Safety                    Food Access    0.170\n374               Community Safety             Food Affordability    0.145\n375               Community Safety     Housing Supply and Quality    0.090\n376               Community Safety   Production Species Diversity    0.110\n377               Community Safety              Production Inputs    0.125\n378               Community Safety Total Quantity Forest Products    0.450\n379               Community Safety         Diverse Representation    0.245\n380               Community Safety                  Age Diversity    0.140\n381         Diverse Representation                 Access to Land    0.125\n382         Diverse Representation     Wealth Income Distribution    0.080\n383         Diverse Representation               Income Stability    0.055\n384         Diverse Representation     Operations Diversification    0.175\n385         Diverse Representation  Use of Ag Farm Crop Insurance    0.145\n386         Diverse Representation                  Carbon Stocks    0.130\n387         Diverse Representation                   Biodiversity    0.605\n388         Diverse Representation             Land Use Diversity    0.105\n389         Diverse Representation                  Water Quality    0.070\n390         Diverse Representation                 Water Quantity    0.070\n391         Diverse Representation         Educational Attainment    0.070\n392         Diverse Representation                Dietary Quality    0.075\n393         Diverse Representation                    Food Access    0.665\n394         Diverse Representation             Food Affordability    0.105\n395         Diverse Representation     Housing Supply and Quality    0.225\n396         Diverse Representation   Production Species Diversity    0.100\n397         Diverse Representation              Production Inputs    0.655\n398         Diverse Representation Total Quantity Forest Products    0.090\n399         Diverse Representation               Community Safety    0.245\n400         Diverse Representation                  Age Diversity    0.760\n401                  Age Diversity                 Access to Land    0.150\n402                  Age Diversity     Wealth Income Distribution    0.610\n403                  Age Diversity               Income Stability    0.075\n404                  Age Diversity     Operations Diversification    0.255\n405                  Age Diversity  Use of Ag Farm Crop Insurance    0.230\n406                  Age Diversity                  Carbon Stocks    0.215\n407                  Age Diversity                   Biodiversity    0.340\n408                  Age Diversity             Land Use Diversity    0.085\n409                  Age Diversity                  Water Quality    0.110\n410                  Age Diversity                 Water Quantity    0.395\n411                  Age Diversity         Educational Attainment    0.325\n412                  Age Diversity                Dietary Quality    0.100\n413                  Age Diversity                    Food Access    0.415\n414                  Age Diversity             Food Affordability    0.260\n415                  Age Diversity     Housing Supply and Quality    0.705\n416                  Age Diversity   Production Species Diversity    0.310\n417                  Age Diversity              Production Inputs    0.155\n418                  Age Diversity Total Quantity Forest Products    0.125\n419                  Age Diversity               Community Safety    0.140\n420                  Age Diversity         Diverse Representation    0.760\n    direction\n1   0.5000000\n2   0.6428571\n3   0.3600000\n4   0.3780488\n5   0.5625000\n6   0.4843750\n7   0.4705882\n8   0.5887097\n9   0.3269231\n10  0.6428571\n11  0.7000000\n12  0.5263158\n13  0.5555556\n14  0.7826087\n15  0.6666667\n16  0.7500000\n17  0.6388889\n18  0.4166667\n19  0.3400000\n20  0.7333333\n21  0.5000000\n22  0.7142857\n23  0.8541667\n24  0.4756098\n25  0.8571429\n26  0.5658915\n27  0.4625000\n28  0.5263158\n29  0.3684211\n30  0.6073826\n31  0.6346154\n32  0.5714286\n33  0.6478873\n34  0.6517857\n35  0.5322581\n36  0.5000000\n37  0.6645570\n38  0.6180556\n39  0.3750000\n40  0.5819672\n41  0.3571429\n42  0.2857143\n43  0.7238806\n44  0.2750000\n45  0.4400000\n46  0.3518519\n47  0.5750000\n48  0.4795918\n49  0.5400000\n50  0.5428571\n51  0.6097561\n52  0.3466667\n53  0.4285714\n54  0.8303571\n55  0.3961039\n56  0.5700935\n57  0.4117647\n58  0.4642857\n59  0.7272727\n60  0.7333333\n61  0.6400000\n62  0.1458333\n63  0.2761194\n64  0.3214286\n65  0.3333333\n66  0.4428571\n67  0.4482759\n68  0.5952381\n69  0.3636364\n70  0.2624113\n71  0.5147059\n72  0.2790698\n73  0.3820755\n74  0.4556213\n75  0.3301887\n76  0.5428571\n77  0.5714286\n78  0.4500000\n79  0.3142857\n80  0.5686275\n81  0.6219512\n82  0.5243902\n83  0.7250000\n84  0.6785714\n85  0.6200000\n86  0.8571429\n87  0.4811321\n88  0.6168831\n89  0.4473684\n90  0.5769231\n91  0.5454545\n92  0.6406250\n93  0.5555556\n94  0.6451613\n95  0.7000000\n96  0.6328125\n97  0.5531915\n98  0.5555556\n99  0.5862069\n100 0.6847826\n101 0.4375000\n102 0.1428571\n103 0.5600000\n104 0.6666667\n105 0.3800000\n106 0.6470588\n107 0.4545455\n108 0.5467836\n109 0.4166667\n110 0.6400000\n111 0.5714286\n112 0.5508475\n113 0.6428571\n114 0.6836735\n115 0.4375000\n116 0.5000000\n117 0.5614035\n118 0.3888889\n119 0.5000000\n120 0.6162791\n121 0.5156250\n122 0.4341085\n123 0.6481481\n124 0.5571429\n125 0.1428571\n126 0.3529412\n127 0.3333333\n128 0.4741379\n129 0.3017241\n130 0.7058824\n131 0.5937500\n132 0.5762712\n133 0.6666667\n134 0.3846154\n135 0.5242718\n136 0.4318182\n137 0.4588608\n138 0.3571429\n139 0.3677686\n140 0.6911765\n141 0.5294118\n142 0.5375000\n143 0.4250000\n144 0.5517241\n145 0.5188679\n146 0.5454545\n147 0.6666667\n148 0.3733333\n149 0.5704225\n150 0.5185185\n151 0.5370370\n152 0.7413793\n153 0.4202128\n154 0.4629630\n155 0.3869048\n156 0.6296296\n157 0.4090909\n158 0.4038462\n159 0.5238095\n160 0.5882353\n161 0.4112903\n162 0.4736842\n163 0.5204082\n164 0.4047619\n165 0.3831169\n166 0.4532164\n167 0.5258621\n168 0.6266667\n169 0.5909091\n170 0.6153846\n171 0.5071429\n172 0.5357143\n173 0.6282051\n174 0.5600000\n175 0.3095238\n176 0.3051948\n177 0.5206612\n178 0.4750000\n179 0.7142857\n180 0.6136364\n181 0.6730769\n182 0.6315789\n183 0.4600000\n184 0.6363636\n185 0.5526316\n186 0.5833333\n187 0.6982759\n188 0.4295775\n189 0.4090909\n190 0.7735849\n191 0.8529412\n192 0.7083333\n193 0.8846154\n194 0.5900000\n195 0.5373134\n196 0.5714286\n197 0.6666667\n198 0.6346154\n199 0.3571429\n200 0.5759494\n201 0.3571429\n202 0.3926174\n203 0.4571429\n204 0.7375887\n205 0.4230769\n206 0.3600000\n207 0.2941176\n208 0.4814815\n209 0.3846154\n210 0.2264151\n211 0.5206612\n212 0.4547872\n213 0.6181818\n214 0.5533333\n215 0.3219178\n216 0.6521739\n217 0.2928571\n218 0.3333333\n219 0.1785714\n220 0.4230769\n221 0.3000000\n222 0.3653846\n223 0.3902439\n224 0.4852941\n225 0.4545455\n226 0.4285714\n227 0.4062500\n228 0.4629630\n229 0.4928571\n230 0.1470588\n231 0.4793388\n232 0.6590909\n233 0.6194030\n234 0.5625000\n235 0.5277778\n236 0.4838710\n237 0.3804348\n238 0.5769231\n239 0.2000000\n240 0.8000000\n241 0.4736842\n242 0.4285714\n243 0.6533333\n244 0.7209302\n245 0.3593750\n246 0.4491525\n247 0.4237288\n248 0.2586207\n249 0.4642857\n250 0.2916667\n251 0.5452128\n252 0.3409091\n253 0.5898438\n254 0.4094203\n255 0.3877551\n256 0.3125000\n257 0.1964286\n258 0.1470588\n259 0.4436090\n260 0.5240964\n261 0.4444444\n262 0.3521127\n263 0.5714286\n264 0.6179245\n265 0.4444444\n266 0.3571429\n267 0.3333333\n268 0.5797872\n269 0.3717949\n270 0.1153846\n271 0.3818182\n272 0.3805970\n273 0.4101562\n274 0.5000000\n275 0.4354839\n276 0.4677419\n277 0.3888889\n278 0.2241379\n279 0.5714286\n280 0.2980769\n281 0.2173913\n282 0.3482143\n283 0.1696429\n284 0.5443787\n285 0.3548387\n286 0.3163265\n287 0.6153846\n288 0.5370370\n289 0.4400000\n290 0.4100000\n291 0.4466667\n292 0.4375000\n293 0.5905797\n294 0.5000000\n295 0.5054348\n296 0.5555556\n297 0.5000000\n298 0.3055556\n299 0.7111111\n300 0.5319149\n301 0.3333333\n302 0.4677419\n303 0.6038961\n304 0.6698113\n305 0.3000000\n306 0.5625000\n307 0.4757282\n308 0.6130952\n309 0.6904762\n310 0.4626866\n311 0.6780822\n312 0.4722222\n313 0.6122449\n314 0.5645161\n315 0.4945652\n316 0.5312500\n317 0.3965517\n318 0.5000000\n319 0.4500000\n320 0.4274194\n321 0.2500000\n322 0.5000000\n323 0.4299065\n324 0.4571429\n325 0.3671875\n326 0.5000000\n327 0.5681818\n328 0.3703704\n329 0.6948052\n330 0.4285714\n331 0.3478261\n332 0.5161290\n333 0.6875000\n334 0.5322581\n335 0.4444444\n336 0.4687500\n337 0.4934211\n338 0.6000000\n339 0.4503817\n340 0.4838710\n341 0.3611111\n342 0.3354430\n343 0.5882353\n344 0.4285714\n345 0.4468085\n346 0.4385965\n347 0.5411392\n348 0.5909091\n349 0.4793388\n350 0.3333333\n351 0.7071429\n352 0.6195652\n353 0.8035714\n354 0.6111111\n355 0.5000000\n356 0.6034483\n357 0.5065789\n358 0.3888889\n359 0.3888889\n360 0.6000000\n361 0.5833333\n362 0.3819444\n363 0.5357143\n364 0.5500000\n365 0.4444444\n366 0.6111111\n367 0.6428571\n368 0.5961538\n369 0.5250000\n370 0.3653846\n371 0.6666667\n372 0.4230769\n373 0.8529412\n374 0.7758621\n375 0.6944444\n376 0.5000000\n377 0.4000000\n378 0.6111111\n379 0.7244898\n380 0.6964286\n381 0.6600000\n382 0.6250000\n383 0.2727273\n384 0.6857143\n385 0.4137931\n386 0.5000000\n387 0.6322314\n388 0.4761905\n389 0.2857143\n390 0.6428571\n391 0.8214286\n392 0.8000000\n393 0.5563910\n394 0.4285714\n395 0.2888889\n396 0.5500000\n397 0.5496183\n398 0.6111111\n399 0.2755102\n400 0.5197368\n401 0.2666667\n402 0.4180328\n403 0.2666667\n404 0.4313725\n405 0.3152174\n406 0.3837209\n407 0.3088235\n408 0.4117647\n409 0.3863636\n410 0.4240506\n411 0.5769231\n412 0.2000000\n413 0.4759036\n414 0.7019231\n415 0.4680851\n416 0.5725806\n417 0.5161290\n418 0.4000000\n419 0.3035714\n420 0.4802632\n```\n\n\n:::\n:::\n\n\n\nCheck the arc strengths for food access:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\narc_str %>% \n  filter(from == 'Food Access')\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          from                             to strength direction\n1  Food Access                 Access to Land    0.190 0.4736842\n2  Food Access     Wealth Income Distribution    0.105 0.4285714\n3  Food Access               Income Stability    0.375 0.6533333\n4  Food Access     Operations Diversification    0.215 0.7209302\n5  Food Access  Use of Ag Farm Crop Insurance    0.160 0.3593750\n6  Food Access                  Carbon Stocks    0.885 0.4491525\n7  Food Access                   Biodiversity    0.295 0.4237288\n8  Food Access             Land Use Diversity    0.145 0.2586207\n9  Food Access                  Water Quality    0.070 0.4642857\n10 Food Access                 Water Quantity    0.180 0.2916667\n11 Food Access         Educational Attainment    0.940 0.5452128\n12 Food Access                Dietary Quality    0.220 0.3409091\n13 Food Access             Food Affordability    0.640 0.5898438\n14 Food Access     Housing Supply and Quality    0.690 0.4094203\n15 Food Access   Production Species Diversity    0.245 0.3877551\n16 Food Access              Production Inputs    0.080 0.3125000\n17 Food Access Total Quantity Forest Products    0.140 0.1964286\n18 Food Access               Community Safety    0.170 0.1470588\n19 Food Access         Diverse Representation    0.665 0.4436090\n20 Food Access                  Age Diversity    0.415 0.5240964\n```\n\n\n:::\n:::\n\n\n\n### Explore Influence\n\n#### Markov Blankets\n\nOne way we can assess influential indicators is with Markov blankets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get Markov blankets\nblankets <- map(names(df), \\(var) {\n  mb(models$dag_hc, var)\n})\n\n# Get number of nodes in each blanket\nblanket_sizes <- map_dbl(blankets, ~ length(.x)) %>% \n  as.data.frame() %>% \n  mutate(names(df), .before = everything()) %>% \n  setNames(c('var', 'size')) %>% \n  arrange(desc(size))\n\n# Show node count\nget_reactable(blanket_sizes)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-35b558d5b7d1c6b6edfd\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-35b558d5b7d1c6b6edfd\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"var\":[\"Food Access\",\"Operations Diversification\",\"Educational Attainment\",\"Food Affordability\",\"Diverse Representation\",\"Housing Supply and Quality\",\"Wealth Income Distribution\",\"Production Inputs\",\"Total Quantity Forest Products\",\"Age Diversity\",\"Carbon Stocks\",\"Land Use Diversity\",\"Production Species Diversity\",\"Biodiversity\",\"Income Stability\",\"Water Quality\",\"Water Quantity\",\"Access to Land\",\"Use of Ag Farm Crop Insurance\",\"Dietary Quality\",\"Community Safety\"],\"size\":[10,9,9,9,9,8,7,7,7,7,6,6,6,5,4,3,3,2,2,2,1]},\"columns\":[{\"id\":\"var\",\"name\":\"var\",\"type\":\"character\"},{\"id\":\"size\",\"name\":\"size\",\"type\":\"numeric\"}],\"resizable\":true,\"filterable\":true,\"searchable\":true,\"defaultPageSize\":10,\"showPageSizeOptions\":true,\"onClick\":\"select\",\"highlight\":true,\"bordered\":true,\"striped\":true,\"compact\":true,\"style\":{\"fontSize\":\"14px\"},\"dataKey\":\"2feb4bcac16122badbb3543db9ef9696\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n#### Arc Strengths\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check arc strengths\n# arc.strength(dag_hc, data = df)\n```\n:::\n\n\n\n\n### Other Things\n\n- Bootstrapped arc stability\n- Hybrid structural learning algorithms (MMHC)\n- Whitelisting and blacklisting\n- Add covariates (no omitted variables)",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"../site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"../site_libs/reactwidget-2.0.0/react-tools.js\"></script>\n<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}